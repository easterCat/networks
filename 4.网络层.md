## 网络层

主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务
网络层数据单位是数据报
> 数据报是比较长的数据，分组是将数据包切割的一个片段

1. 功能1：路由选择和分组转发
2. 功能2：异构网络互连
3. 功能3：拥塞控制
  - 开环控制（静态）
  - 闭环控制（动态）

（流量控制是发送方发送速度过快，接收方告诉发送方发慢）
（拥塞控制，整个网络负载过重，导致分组转发速率慢，大部分分组丢弃）

## 数据交换方式

#### 电路交换
电话网络，固定的占用一条线路
![网络层1](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%821.png?raw=true)

特点
- 独占资源

优点
- 通信时延小
- 有序传输
- 没有冲突
- 实时性强

缺点
- 建立连接时间长
- 线路独占，使用效率低
- 灵活性差
- 无差错控制能力

#### 报文交换
报文：源应用发送的信息整体
![网络层2](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%822.png?raw=true)
优点
- 无需建立连接
- 存储转发，动态分配线路
- 线路可靠性较高
- 线路利用率较高
- 多目标服务

缺点
- 有存储转发时延
- 报文大小不定，需要网络节点有较大缓存空间

#### 分组交换
分组：将大的数据块分割成小的数据块（切割报文）
![网络层3](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%823.png?raw=true)
优点
- 无需建立连接
- 存储转发，动态分配路线
- 线路可靠性较高
- 线路利用率较高
- 相对于报文交换，存储管理更容易（对缓存要求低了）

缺点
- 有存储转发时延
- 需要传输额外的信息量
- 乱序到目的主机，需要对分组排序重组


#### 3种交换方式总结
1. 报文交换和分组交换都使用存储转发
2. 传送数据量大，且传送时间远大于呼叫时，使用电路交换。电路交换时延最小
3. 信道利用率上，报文交换和分组交换优于电路交换，其中分组交换时延较小
![网络层4](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%824.png?raw=true)

#### 数据报方式
数据报为网络层提供无连接服务
（无连接服务：不事先为分组的传输确定传输路径，每个分组独立确定路径，不同分组的传输路径可能不同）

##### 数据报
- 无连接
- 每个分组携带源和目的地址
- 路由器根据分组的目的地址转发分组：基于路由协议/算法构建转发表，检索转发表，每个分组独立选路

#### 虚电路方式
虚电路为网络层提供连接服务
（连接服务：首先为分组确定传输路径，然后沿该路径传输系列分组，系列分组传输路径相同，传输结束后拆除连接）

##### 虚电路
虚电路将数据报方式和电路交换方式结合，发挥两者优点
虚电路是一条源主机到目的主机类似于电路的路径（逻辑连接），路径上所有节点都要维持这个虚电路的建立，都维持一个虚电路表，每一项记录了一个打开的虚电路的信息。
![网络层5](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%825.png?raw=true)
通信过程
1. 源主机发送呼叫请求分组并收到呼叫应答分组后才算建立连接
2. 数据传输过程（全双工通信）
3. 完毕后拆除虚电路

>每个分组携带虚电路号，而非目的地址

![网络层6](https://github.com/easterCat/networks/blob/master/img4/%E7%BD%91%E7%BB%9C%E5%B1%826.png?raw=true)
------

## 传输单元名词
参考模型|单位
--|:--:
应用层|报文
传输层|报文段
网络层|IP数据报，分组（数据报切割后）
数据链路层|帧
物理层|比特流